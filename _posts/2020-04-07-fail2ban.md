---
title: Mengamankan SSH dengan Fail2ban
date: '2020-04-07 01:37:48 +0700'
draft: false
tags:
- fail2ban
- ubuntu
- centos
author: iqbal
---

Disini saya akan menggunakan fail2ban untuk meminimalisir serangan brute force ke service SSH.

## Update repository

Ubuntu 18.04 LTS
<pre>
apt update -y
apt upgrade -y
</pre>

CentOS 7
<pre>
yum install epel-release -y
yum update -y
yum upgrade -y
</pre>

## Install Fail2ban

Ubuntu 18.04 LTS
<pre>
apt install fail2ban -y
</pre>

CentOS 7
<pre>
yum install fail2ban -y
</pre>

### Start fail2ban

<pre>
systemctl start fail2ban
systemctl enable fail2ban
</pre>

### Konfigurasi fail2ban

- Salin file `jail.conf` ke `jail.local`
    <pre>
    cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local
    </pre>

- Buat konfigurasi

    <pre>
    vim /etc/fail2ban/jail.local
    </pre>

    Masukan konfigurasi seperti berikut terlebih dahulu:

    <pre>
    ignoreip = 127.0.0.1/8 ::1 (pengecualian IP untuk tidak diban pada saat gagal login)
    bantime = -1 (Banned permanen IP)
    findtime = 300s (waktu yang ditentukan, apakah IP layak di ban)
    maxretry = 3 (3x percobaan gagal= banned)
    </pre>

    Buat konfigurasi untuk SSH:

    <pre>
    [sshd]
    enabled = true
    port    = ssh
    logpath = %(sshd_log)s
    backend = %(sshd_backend)s
    </pre>
    Simpan dan restart fail2ban

### Status jail fail2ban

Untuk melihat status jail fail2ban dapat menggunakan perintah berikut:

<pre>
fail2ban-client status sshd
</pre>

![Jail status](https://earth-id-jkt-1.bal.web.id/assets/gambar/2020/fail2ban-jail-status.png)

Masukan perintah berikut untuk melihat log fail2ban:

<pre>
tail -f /var/log/fail2ban.log
</pre>

![Log fail2ban](https://earth-id-jkt-1.bal.web.id/assets/gambar/2020/fail2ban-banned-ip.png)

### Unban IP

Untuk melakukan unban IP, dapat menggunakan perintah berikut:

<pre>
fail2ban-client set sshd unbanip IP_ADDRESS
</pre>

Sekian dan terima kasih..
